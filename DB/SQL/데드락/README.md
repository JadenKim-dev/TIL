# 데드락

데이터베이스에서 데드락(Deadlock)은 두 개 이상의 트랜잭션이 서로의 자원을 기다리면서 무한 대기 상태에 빠지는 현상을 말합니다.  
이는 동시에 실행되는 여러 트랜잭션이 각각 다른 트랜잭션이 점유하고 있는 자원을 요청할 때 발생합니다.

### 데드락 발생 조건

데드락이 발생하기 위해서는 네 가지 조건이 동시에 만족해야 합니다:

1. **상호 배제(Mutual Exclusion)**:  

자원은 한 번에 하나의 트랜잭션만이 사용할 수 있어야 합니다.  
즉, 자원이 한 트랜잭션에 의해 점유되면 다른 트랜잭션은 그 자원을 사용할 수 없습니다.

2. **점유 및 대기(Hold and Wait)**:  

트랜잭션이 이미 하나 이상의 자원을 점유한 상태에서 추가 자원을 요청하면서, 그 자원이 할당될 때까지 대기해야 합니다.

3. **비선점(Non-preemption)**: 

다른 트랜잭션이 점유한 자원을 강제로 빼앗을 수 없습니다.  
즉, 자원을 점유한 트랜잭션이 자원을 자발적으로 해제할 때까지 기다려야 합니다.

4. **순환 대기(Circular Wait)**:  

두 개 이상의 트랜잭션이 자원을 기다리며 서로 순환적으로 대기하는 상태를 의미합니다.  
예를 들어, 트랜잭션 A가 트랜잭션 B가 점유한 자원을 기다리고, 트랜잭션 B는 트랜잭션 A가 점유한 자원을 기다리는 경우입니다.

### 데드락 해결 방법

데드락을 해결하거나 예방하기 위해 여러 가지 방법이 사용됩니다:

1. **예방(Prevention)**:  

데드락이 발생하지 않도록 아예 네 가지 조건 중 하나 이상을 제거하는 방법입니다.  
예를 들어, 트랜잭션이 자원을 요청하기 전에 모든 필요한 자원을 미리 점유하게 하거나, 점유한 자원이 있을 경우 새로운 자원을 요청하지 못하도록 하는 방법이 있습니다.

2. **회피(Avoidance)**:  

자원 할당 그래프(Resource Allocation Graph)를 사용하여 데드락이 발생할 가능성이 있는지 판단하고, 위험이 있으면 트랜잭션을 대기시키는 방법입니다.

3. **탐지(Detection)**:  

주기적으로 시스템을 검사하여 데드락이 발생했는지 확인하고, 데드락이 발생했을 경우 이를 해결하는 방법입니다.  
데드락이 탐지되면, 보통 트랜잭션을 강제 종료시키거나 자원의 선점을 통해 데드락을 해소합니다.

4. **회복(Recovery)**:  

데드락이 탐지된 후에 이를 해결하는 방법으로, 일반적으로 데드락을 일으킨 트랜잭션 중 일부를 중단하고 롤백하여 시스템을 정상 상태로 되돌립니다.

데드락은 시스템의 성능과 신뢰성에 심각한 영향을 줄 수 있기 때문에, 이를 예방하거나 신속히 탐지하고 해결하는 것이 중요합니다.

# TLS(Transport Layer Security)

TLS(Transport Layer Security)는 인터넷 통신에서 데이터를 안전하게 전송하기 위한 암호화 프로토콜입니다.  
TLS는 클라이언트와 서버 간의 데이터 통신을 보호하여 중간에서의 도청 및 변조를 방지하는 역할을 합니다.  
이전에는 SSL(Secure Sockets Layer)이라는 이름으로 사용되었으나, 여러 보안 문제로 인해 현재는 TLS로 대체되었습니다.

### 1. 핸드셰이크 과정 (TLS Handshake)

TLS 통신은 핸드셰이크(handshake)로 시작됩니다.  
이 과정에서 클라이언트와 서버는 서로의 인증서를 교환하고, 암호화 알고리즘과 키 교환 방식 등을 협의합니다.

주요 과정은 다음과 같습니다:

- **Client Hello**:  
  클라이언트가 서버에게 TLS 버전, 지원 가능한 암호화 알고리즘, 무작위 숫자(Random Number)를 전송합니다.
- **Server Hello**:  
  서버는 클라이언트가 제안한 암호화 알고리즘 중 하나를 선택하고, 자신의 인증서(SSL 인증서)를 클라이언트에게 전송하며, 무작위 숫자를 전송합니다.
- **Key Exchange**:  
  서버는 클라이언트에게 공개 키를 전송하거나, 클라이언트와 서버 간에 세션 키를 공유할 수 있는 방법을 제안합니다.
- **Client Key Exchange**:  
  클라이언트는 서버의 공개 키를 사용하여 암호화한 세션 키를 서버에게 전송합니다.  
  이 세션 키는 이후 통신에서 사용될 대칭 키입니다.
- **Finished**:  
  양측은 설정된 세션 키를 사용하여 마지막으로 메시지를 암호화하여 전송하고, 이를 통해 핸드셰이크가 정상적으로 완료되었음을 확인합니다.

### 2. 데이터 전송

handshake가 완료되면 클라이언트와 서버는 대칭 키 암호화를 사용하여 데이터를 암호화하여 안전하게 전송합니다.  
이 단계에서 전송되는 데이터는 모두 암호화되어 있기 때문에 중간에 누군가가 데이터를 가로채더라도 내용을 확인하거나 변조할 수 없습니다.

### 3. 연결 종료

통신이 끝나면 클라이언트와 서버는 연결을 종료합니다.  
이 과정에서 세션 키와 같은 암호화 정보를 삭제하여 이후 재사용되지 않도록 합니다.

### TLS의 주요 기능

- **기밀성(Confidentiality)**: 암호화를 통해 데이터를 보호하여 외부에서 내용을 알 수 없도록 합니다.
- **무결성(Integrity)**: 전송된 데이터가 도중에 변조되지 않았음을 보장합니다.
- **인증(Authentication)**: 서버와 클라이언트가 서로 신뢰할 수 있는 상대방인지 확인합니다.

TLS는 HTTPS를 통해 웹 브라우저와 웹 서버 간의 안전한 통신을 제공하는 데 널리 사용되며, 이메일, VoIP, 메신저 등 다양한 인터넷 서비스에서 사용됩니다.  
현재 널리 사용되는 TLS 버전은 TLS 1.2와 TLS 1.3입니다.  
TLS 1.3은 더 강화된 보안을 제공하며, handshake 과정을 간소화하여 성능도 향상되었습니다.

## mTLS(Mutual TLS)

mTLS(mutual TLS 또는 mutual Transport Layer Security)은 TLS의 확장 형태로, 클라이언트와 서버가 서로를 인증하는 방식입니다.  
일반적인 TLS에서는 클라이언트가 서버를 인증하고, 서버는 클라이언트를 인증하지 않지만, mTLS에서는 양쪽 모두가 상대방의 신원을 확인합니다.  
이 방법은 높은 수준의 보안을 요구하는 시스템에서 자주 사용됩니다.

### mTLS의 동작 방식

mTLS는 일반 TLS와 유사한 handshake 과정을 거치지만, 몇 가지 차이점이 있습니다:

1. **서버 인증**:  
   클라이언트가 서버에 연결을 시도하면, 서버는 자신의 인증서를 클라이언트에게 전송하여 신원을 증명합니다. 클라이언트는 서버의 인증서를 확인하여 해당 서버가 신뢰할 수 있는지 판단합니다.

2. **클라이언트 인증**:  
   일반적인 TLS에서는 여기서 핸드셰이크가 끝나지만, mTLS에서는 서버가 클라이언트에게도 인증서를 요구합니다. 클라이언트는 자신의 인증서를 서버에 전송하여 신원을 증명합니다.

3. **서버 측 클라이언트 인증 확인**:  
   서버는 클라이언트가 제출한 인증서를 확인하여 클라이언트가 신뢰할 수 있는지 판단합니다.

4. **세션 키 교환 및 데이터 암호화**:  
   양측의 인증이 완료되면, TLS와 마찬가지로 세션 키가 교환되고, 이후의 데이터 전송은 이 키를 사용하여 암호화된 상태로 이루어집니다.

### mTLS의 사용 사례

mTLS는 특히 다음과 같은 상황에서 유용합니다:

- **API 통신**:  
  mTLS는 두 서비스 간의 API 통신을 안전하게 보호하기 위해 사용됩니다.  
  클라이언트와 서버 모두가 인증되기 때문에, API 요청이 신뢰할 수 있는 출처에서 온 것임을 보장할 수 있습니다.
- **내부 네트워크 보안**:  
  기업 내의 민감한 데이터 전송이나 내부 시스템 간의 통신을 보호하기 위해 사용됩니다.
- **은행 및 금융 서비스**:  
  고도의 보안을 요구하는 금융 기관에서는 고객과 서버 간의 통신을 안전하게 보호하기 위해 mTLS를 채택하는 경우가 많습니다.

### mTLS의 장점과 단점

**장점**:

- **높은 보안 수준**: 양측 모두 인증하므로, 데이터 도청이나 변조의 위험을 크게 줄일 수 있습니다.
- **신뢰성**: 인증된 클라이언트만이 서버에 접근할 수 있어, 신뢰성 있는 통신을 보장합니다.

**단점**:

- **복잡성**: mTLS를 설정하고 관리하는 과정은 일반적인 TLS보다 복잡하며, 인증서 관리에 대한 추가적인 노력이 필요합니다.
- **성능**: 양측 인증 과정이 추가되므로, 핸드셰이크 과정에서 시간이 더 소요될 수 있습니다.

mTLS는 이와 같은 장점 덕분에 보안이 중요한 환경에서 매우 유용하지만, 모든 환경에서 필요하지는 않기 때문에 적절한 사용 시나리오를 잘 고려하는 것이 중요합니다.
